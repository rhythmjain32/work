<?php

// $sql = "CREATE DATABASE IF NOT EXISTS DBName;";

// if (mysqli_query($conn, $sql)) {
//     echo "Database created successfully";
// } else {
//     echo "Error creating database: " . mysqli_error($conn);
// }

// $servername = "localhost";
// $username = "root";
// $password = "";
// $dbname = "DBname";

// $conn = mysqli_connect($servername, $username, $password, $dbname);





$errorname = $errormail = "";
$name = $mail = "";
$count = 0;

if (isset($_POST['submit'])) {

    $name = $_POST["name"];
    $mail = $_POST["mail"];

    if (empty($name)) {
        $errorname = "write a valid name you piece of shit";
    } else {
        if (!preg_match("/^[a-zA-Z-' ]*$/", $name)) {
            $errorname = "are you kid of elon musk";
        } else {
            $count = $count + 1;
        }
    }

    if (empty($mail)) {
        $errormail = "write a valid name you piece of shit";
    } else {
        if (!filter_var($mail, FILTER_VALIDATE_EMAIL)) {
            $errormail = "write something that make what?";
        } else {
            $count = $count + 1;
        }
    }

    if ($count == 2) {
        $servername = "localhost";
        $username = "root";
        $password = "";

        // Create connection
        $conn = mysqli_connect($servername, $username, $password);
        // Check connection
        if (!$conn) {
            die("Connection failed: " . mysqli_connect_error());
        }

        // Create database
        $sql = "CREATE DATABASE myDB";
        if (mysqli_query($conn, $sql)) {
            echo "Database created successfully";
        } else {
            $conn = mysqli_connect($servername, $username, $password, 'myDB');

            if ($conn) {

                $sql = "CREATE TABLE form(name VARCHAR(255)NOT NULL,email VARCHAR(255)NOT NULL,);";
                if (mysqli_query($conn, $sql)) {
                    echo "Created user table";
                } else {
                    $sql = "INSERT INTO form(name,  email)VALUES ('$name', '$mail')";

                    if (mysqli_query($conn, $sql)) {
                        echo "New record created successfully";
                    } else {
                        echo "Error: " . $sql . "<br>" . mysqli_error($conn);
                    }
                }
            } else {
                echo "error : DB isnot connected";
            }
        }
    }
}

?>
<form method="POST" action="./_1.php">
    Name: <input type="text" name="name">
    <?php echo $errorname; ?>
    <br><br>
    mail: <input type="text" name="mail">
    <?php echo $errormail; ?>
    <br><br>

    <button type="submit" name="submit">sumbit</button>

</form>